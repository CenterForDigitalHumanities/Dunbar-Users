<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Log Out</title>
    <style>
        #loginStatus{
            font-size:  125%;
            font-weight:  bolder;
        }
    </style>
</head>

<body class="container">
    <p>
        This page will log you out of DLA.
        <a target="_blank" href="/login.html">Login here</a>.
    </p>
    <div id="loginStatus"> YOU ARE NOT LOGGED IN </div>
    <script src="https://cdn.auth0.com/js/auth0/9.11/auth0.min.js"></script>
    <script type="text/javascript">
        const AUDIENCE = "http://dunbar-users.rerum.io/api"
        const ISSUER_BASE_URL = "cubap.auth0.com"
        const CLIENTID = "z1DuwzGPYKmF7POW9LiAipO5MvKSDERM"
        const DUNBAR_REDIRECT = "http://localhost:3000/login.html"

        logout()

        function logout(){
            //Make it so that the token or session is seen as dead on Auth0
            var webAuth = new auth0.WebAuth({
                domain:       ISSUER_BASE_URL,
                clientID:     CLIENTID
            })
            webAuth.logout({
                returnTo: DUNBAR_REDIRECT,
                client_id: CLIENTID
            })
            .then(res => {
                //Get rid of the session info from sessionStorage and localStorage and cookies
                sessionStorage.removeItem('Agent-URI')
                sessionStorage.removeItem('Dunbar-Token')
                localStorage.removeItem('Agent-URI')
                localStorage.removeItem('Dunbar-Token')
                document.cookie = "Agent-URI=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "Dunbar-Token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";    
            })

        }
    </script>
</body>

</html>
